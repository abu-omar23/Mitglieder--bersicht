<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vereinsmitglieder √úbersicht</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f2f4f8;
    margin: 0;
    padding: 0;
  }
  header {
    background: #0057b7;
    color: white;
    padding: 1rem 2rem;
    text-align: center;
  }
  main {
    max-width: 1100px;
    margin: 2rem auto;
    background: white;
    padding: 1.5rem;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  h2 { text-align: center; color: #333; }

  /* Buttons und Filter */
  .top-bar {
    display: flex; justify-content: space-between;
    align-items: center; flex-wrap: wrap;
    gap: .5rem; margin-bottom: 1rem;
  }
  button {
    background: #0057b7; color: white; border: none;
    padding: .5rem 1rem; border-radius: 6px; cursor: pointer;
  }
  button:hover { background: #004199; }
  .btn-add { background: #008c45; }
  .btn-add:hover { background: #007538; }

  .search-icon {
    background: white; color: #0057b7;
    border: 2px solid #0057b7;
    border-radius: 50%; width: 35px; height: 35px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-weight: bold;
  }
  .search-icon:hover { background: #0057b7; color: white; }
  #searchField {
    display: none;
    padding: .5rem; border-radius: 6px; border: 1px solid #ccc;
  }

  .filter-box {
    text-align: center; margin-bottom: 1rem;
  }
  select#filterSelect {
    padding: .4rem .6rem; border-radius: 6px;
    border: 1px solid #ccc; background: #f9f9f9;
  }

  table {
    width: 100%; border-collapse: collapse;
  }
  th, td {
    padding: .7rem; border-bottom: 1px solid #ddd;
    text-align: left;
  }
  th {
    background: #f0f0f0; cursor: pointer; user-select: none;
    position: relative;
  }
  th span.arrow {
    font-size: .8rem; color: #999; margin-left: .3rem;
  }
  tr:hover { background: #f9f9f9; }

  .tab-buttons {
    display: flex; justify-content: center;
    gap: 1rem; margin-top: 1rem;
  }
  .tab-buttons button {
    background: #ddd; color: black;
  }
  .tab-buttons button.active {
    background: #0057b7; color: white;
  }

  .info-btn {
    border: none; background: #0057b7; color: white;
    border-radius: 50%; width: 28px; height: 28px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-weight: bold;
  }
  .info-btn:hover { background: #004199; }

  /* Modal */
  .modal {
    display: none; position: fixed; z-index: 10;
    left: 0; top: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.5);
    justify-content: center; align-items: center;
  }
  .modal-content {
    background: white; padding: 1.5rem; border-radius: 10px;
    width: 90%; max-width: 420px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
  }
  .modal-content input, .modal-content select {
    width: 100%; padding: .5rem; margin-bottom: .8rem;
    border: 1px solid #ccc; border-radius: 6px;
  }
  .modal-buttons {
    display: flex; justify-content: space-between;
    flex-wrap: wrap; gap: .5rem;
  }
  .cancel { background: #888; }
  .cancel:hover { background: #666; }
  .btn-remove { background: #c0392b; }
  .btn-remove:hover { background: #a93226; }
  .btn-warning { background: #ffa500; }
  .btn-warning:hover { background: #e59500; }

  .confirm-area {
    background: #f2f2f2; border-radius: 8px;
    padding: .7rem; margin-top: .7rem;
  }
</style>
</head>
<body>
<header><h1>Vereinsmitglieder √úbersicht</h1></header>
<main>
  <h2>Mitgliederverwaltung</h2>

  <div class="top-bar">
    <button class="btn-add" onclick="openAddModal()">+ Neues Mitglied</button>
    <div style="display:flex;align-items:center;gap:.5rem;">
      <div class="search-icon" onclick="toggleSearch()">üîç</div>
      <input type="text" id="searchField" placeholder="Nach Name suchen..." onkeyup="searchMembers()">
    </div>
  </div>

  <div class="filter-box">
    <label for="filterSelect">Filtern nach: </label>
    <select id="filterSelect" onchange="filterMembers(this.value)">
      <option value="alle">Alle</option>
      <option value="Boxen">Boxen</option>
      <option value="Kickboxen">Kickboxen</option>
      <option value="Kinder">Kinder</option>
      <option value="Erwachsene">Erwachsene</option>
    </select>
  </div>

  <div class="tab-buttons">
    <button id="tabActive" class="active" onclick="showTab('active')">Aktive Mitglieder</button>
    <button id="tabCancelled" onclick="showTab('cancelled')">Gek√ºndigte Mitglieder</button>
  </div>

  <table id="activeTable">
    <thead>
      <tr>
        <th onclick="sortTable('firstName')">Vorname<span class="arrow" id="arrow-firstName">‚ñ≤</span></th>
        <th onclick="sortTable('lastName')">Nachname<span class="arrow" id="arrow-lastName">‚ñº</span></th>
        <th onclick="sortTable('gender')">Geschlecht<span class="arrow" id="arrow-gender">‚ñº</span></th>
        <th onclick="sortTable('birthdate')">Geburtsdatum<span class="arrow" id="arrow-birthdate">‚ñº</span></th>
        <th onclick="sortTable('phone')">Telefon<span class="arrow" id="arrow-phone">‚ñº</span></th>
        <th onclick="sortTable('email')">E-Mail<span class="arrow" id="arrow-email">‚ñº</span></th>
        <th onclick="sortTable('joinDate')">Beitritt<span class="arrow" id="arrow-joinDate">‚ñº</span></th>
        <th onclick="sortTable('sport')">Sportart<span class="arrow" id="arrow-sport">‚ñº</span></th>
        <th onclick="sortTable('group')">Gruppe<span class="arrow" id="arrow-group">‚ñº</span></th>
        <th></th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <table id="cancelledTable" style="display:none;">
    <thead>
      <tr>
        <th>Vorname</th><th>Nachname</th><th>Geschlecht</th>
        <th>Geburtsdatum</th><th>Telefon</th><th>E-Mail</th>
        <th>Beitritt</th><th>K√ºndigungsdatum</th><th>Sportart</th><th>Gruppe</th><th></th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</main>

<!-- Modals -->
<div id="memberModal" class="modal">
  <div class="modal-content">
    <h3 id="modalTitle">Mitglied hinzuf√ºgen</h3>
    <label>Vorname:</label><input id="firstName">
    <label>Nachname:</label><input id="lastName">
    <label>Geschlecht:</label>
    <select id="gender"><option value="">Bitte w√§hlen</option><option>M</option><option>W</option></select>
    <label>Geburtsdatum:</label><input type="date" id="birthdate">
    <label>Beitrittsdatum:</label><input type="date" id="joinDate">
    <label>Telefon:</label><input id="phone">
    <label>E-Mail:</label><input type="email" id="email">
    <label>Sportart:</label>
    <select id="sport"><option value="">Bitte w√§hlen</option><option>Boxen</option><option>Kickboxen</option></select>
    <label>Gruppe:</label>
    <select id="group"><option value="">Bitte w√§hlen</option><option>Kinder</option><option>Erwachsene</option></select>
    <div class="modal-buttons">
      <button onclick="saveMember()">Speichern</button>
      <button class="cancel" onclick="closeModal()">Abbrechen</button>
    </div>
  </div>
</div>

<div id="infoModal" class="modal">
  <div class="modal-content">
    <h3>Mitgliedsinfo</h3>
    <div id="infoText"></div>
    <div id="confirmArea" class="confirm-area" style="display:none;"></div>
    <div class="modal-buttons">
      <button class="btn-warning" onclick="openEditFromInfo()">Bearbeiten</button>
      <button class="btn-remove" onclick="askConfirm('cancel')">K√ºndigen</button>
      <button class="btn-remove" onclick="askConfirm('delete')">L√∂schen</button>
      <button class="cancel" onclick="closeInfo()">Schlie√üen</button>
    </div>
  </div>
</div>

<script>
let members=JSON.parse(localStorage.getItem('members'))||[];
let cancelled=JSON.parse(localStorage.getItem('cancelled'))||[];
let currentIndex=null,sortKey='firstName',sortAsc=true,filter='alle';

function formatDate(d){if(!d)return'';d=new Date(d);return `${String(d.getDate()).padStart(2,'0')}.${String(d.getMonth()+1).padStart(2,'0')}.${d.getFullYear()}`;}
function calcAge(b){const birth=new Date(b);return new Date(Date.now()-birth).getUTCFullYear()-1970;}
function renderTables(){
 const a=document.querySelector('#activeTable tbody'),c=document.querySelector('#cancelledTable tbody');
 a.innerHTML='';c.innerHTML='';
 let list=[...members];
 list.sort((x,y)=>(x[sortKey]||'').localeCompare(y[sortKey]||'','de',{numeric:true})*(sortAsc?1:-1));
 list.forEach((m,i)=>{
   if(filter!=='alle'&&m.sport!==filter&&m.group!==filter)return;
   a.innerHTML+=`<tr><td>${m.firstName}</td><td>${m.lastName}</td><td>${m.gender}</td><td>${formatDate(m.birthdate)}</td><td>${m.phone}</td><td>${m.email}</td><td>${formatDate(m.joinDate)}</td><td>${m.sport}</td><td>${m.group}</td><td><button class="info-btn" onclick="openInfo(${i})">i</button></td></tr>`;
 });
 cancelled.forEach((m,i)=>{
   c.innerHTML+=`<tr><td>${m.firstName}</td><td>${m.lastName}</td><td>${m.gender}</td><td>${formatDate(m.birthdate)}</td><td>${m.phone}</td><td>${m.email}</td><td>${formatDate(m.joinDate)}</td><td>${formatDate(m.cancelDate)}</td><td>${m.sport}</td><td>${m.group}</td><td><button class="info-btn" onclick="openInfoCancelled(${i})">i</button></td></tr>`;
 });
 localStorage.setItem('members',JSON.stringify(members));
 localStorage.setItem('cancelled',JSON.stringify(cancelled));
}
function sortTable(k){
 if(sortKey===k)sortAsc=!sortAsc;else{sortKey=k;sortAsc=true;}
 document.querySelectorAll('th span.arrow').forEach(a=>a.style.color='#999');
 document.getElementById('arrow-'+k).style.color='#0057b7';
 renderTables();
}
function openAddModal(){currentIndex=null;
 document.getElementById('modalTitle').textContent='Neues Mitglied hinzuf√ºgen';
 document.querySelectorAll('#memberModal input,#memberModal select').forEach(e=>e.value='');
 document.getElementById('memberModal').style.display='flex';
}
function saveMember(){
 const m={firstName:firstName.value.trim(),lastName:lastName.value.trim(),gender:gender.value,birthdate:birthdate.value,joinDate:joinDate.value,phone:phone.value.trim(),email:email.value.trim(),sport:sport.value,group:group.value};
 if(!m.firstName||!m.lastName)return alert('Vor- und Nachname erforderlich');
 if(currentIndex!=null)members[currentIndex]=m;else members.push(m);
 renderTables();closeModal();
}
function openEditFromInfo(){closeInfo();const m=members[currentIndex];
 modalTitle.textContent='Mitglied bearbeiten';
 firstName.value=m.firstName;lastName.value=m.lastName;gender.value=m.gender;birthdate.value=m.birthdate;joinDate.value=m.joinDate;phone.value=m.phone;email.value=m.email;sport.value=m.sport;group.value=m.group;
 memberModal.style.display='flex';
}
function openInfo(i){
 currentIndex=i;const m=members[i];const age=calcAge(m.birthdate);
 infoText.innerHTML=`<strong>${m.firstName} ${m.lastName}</strong><br>Geschlecht: ${m.gender}<br>Alter: ${age} Jahre<br>Sportart: ${m.sport}<br>Gruppe: ${m.group}<br>E-Mail: ${m.email}<br>Telefon: ${m.phone}`;
 confirmArea.style.display='none';
 infoModal.style.display='flex';
}
function openInfoCancelled(i){
 const m=cancelled[i];const age=calcAge(m.birthdate);
 infoText.innerHTML=`<strong>${m.firstName} ${m.lastName}</strong><br>Geschlecht: ${m.gender}<br>Alter: ${age} Jahre<br>K√ºndigungsdatum: ${formatDate(m.cancelDate)}<br>Sportart: ${m.sport}<br>Gruppe: ${m.group}<br>E-Mail: ${m.email}<br>Telefon: ${m.phone}`;
 confirmArea.style.display='none';
 infoModal.style.display='flex';
 document.querySelectorAll('#infoModal .btn-warning,.btn-remove').forEach(b=>b.style.display='none');
}
function askConfirm(a){
 confirmArea.style.display='block';
 confirmArea.innerHTML=`<p>Sicher, dass du dieses Mitglied ${a==='cancel'?'k√ºndigen':'l√∂schen'} willst?</p><div style="display:flex;gap:.5rem;"><button class="btn-remove" onclick="${a==='cancel'?'doCancel()':'doDelete()'}">Ja</button><button class="cancel" onclick="cancelConfirm()">Nein</button></div>`;
}
function cancelConfirm(){confirmArea.style.display='none';}
function doCancel(){const m=members[currentIndex];m.cancelDate=new Date().toISOString();cancelled.push(m);members.splice(currentIndex,1);renderTables();closeInfo();}
function doDelete(){members.splice(currentIndex,1);renderTables();closeInfo();}
function closeModal(){memberModal.style.display='none';}
function closeInfo(){infoModal.style.display='none';}
function showTab(t){tabActive.classList.remove('active');tabCancelled.classList.remove('active');activeTable.style.display='none';cancelledTable.style.display='none';if(t==='active'){tabActive.classList.add('active');activeTable.style.display='table';}else{tabCancelled.classList.add('active');cancelledTable.style.display='table';}}
function filterMembers(f){filter=f;renderTables();}
function toggleSearch(){searchField.style.display=searchField.style.display==='none'?'block':'none';searchField.value='';searchMembers();}
function searchMembers(){const q=searchField.value.toLowerCase();document.querySelectorAll('#activeTable tbody tr').forEach(r=>r.style.display=r.textContent.toLowerCase().includes(q)?'':'none');}
window.onclick=e=>{if(e.target.classList.contains('modal')){closeModal();closeInfo();}}
renderTables();
</script>
</body>
</html>
